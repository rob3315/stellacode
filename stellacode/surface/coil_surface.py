from pydantic import BaseModel, Extra

from .abstract_surface import AbstractSurface
from .current_potential import CurrentPotential
from .imports import get_current_potential, get_cws_grid


class CoilSurface(AbstractSurface):
    """A class used to:
    * represent an abstract surfaces
    * computate of the magnetic field generated by a current carried by the surface.
    * visualize surfaces
    """

    surface: AbstractSurface
    current: CurrentPotential

    class Config:
        arbitrary_types_allowed = True
        extra = Extra.allow  # allow extra fields

    @classmethod
    def from_config(cls, config):
        current_potential = get_current_potential(config)
        surface = get_cws_grid(config)

        return cls(surface=surface, current_potential=current_potential)

    def get_curent_potential_op(self):
        return self.current_potential.get_matrix_from_grid(self.grids)
